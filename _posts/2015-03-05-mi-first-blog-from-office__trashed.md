---
layout: post
title: Better Documenting your BizTalk Solutions
date: 2015-03-05 08:46
author: Paco de la Cruz
comments: true
categories: [Uncategorized]
---
<p>The BizTalk Documenter has been available for many years on Codeplex for different BizTalk versions, starting with 2004 all the way to 2013 R2. The Documenter for 2004, 2006, 2006R2 and 2009 can be found <a href="https://biztalkdocumenter.codeplex.com/">here</a>. Some years later, a version for <a href="https://biztalk2010autodc.codeplex.com/">BizTalk 2010</a> was created. Last year, <a href="https://www.codeplex.com/site/users/view/mbrimble">MBrimble</a> and <a href="https://www.codeplex.com/site/users/view/Dijkgraaf">Dijkgraaf</a> created a <a href="https://biztalk2013documenter.codeplex.com/">newer version</a> which also supports BizTalk 2013 and 2013 R2. They did a great job; all improvements and fixes are listed <a href="https://connectedpawns.wordpress.com/2014/09/12/biztalk-documenter-2013/">here</a>.
</p><p>As in many things in life, there is always room for further improvement. While using the BizTalk 2013 Documenter, I realised that some changes could be done to better document BizTalk Solutions. I downloaded the source code and did some changes for my own, but then after sharing with the <a href="https://biztalk2013documenter.codeplex.com/team/view">team</a> what I had done, they invited me to collaborate in the project. I created the <a href="https://biztalk2013documenter.codeplex.com/releases/view/611182">BizTalk 2013 Documenter 5.1.7.0</a> for BizTalk 2013 with some fixes and improvements.
</p><p>I will share here not only the changes that I did, but some tips that I consider can help you to better document your BizTalk solutions. If you would like to implement them, please make sure you have got the <a href="https://biztalk2013documenter.codeplex.com/releases/view/611182">latest version of the Documenter</a>. 
</p><h1><span style="font-size:12pt;">1. Leverage the BizTalk Documenter. 
</span></h1><p>The first and obvious tip is to leverage the BizTalk Documenter. This tool allows you to create a CHM file describing your BizTalk environment and BizTalk Solutions. The first main section of the generated documentation contains your BizTalk Applications, listing all their artefacts and providing a navigable and very graphical documentation of all artefacts. The second main section describes the platform settings like hosts and adapters. The third main section documents BRE policies and vocabularies. You can expect an output similar to the one shown below. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum1.png" alt="" />
	</p><h1><span style="font-size:12pt;">2. Use embedded documentation as much as possible. 
</span></h1><p>The practice of embedding documentation can be applied to your BizTalk Solutions. Using the BizTalk artefact's description field within the Admin Console allows you to describe the purpose and function of each artefact and keep this always visible for administrators and developers. If you use the <a href="https://biztalkdeployment.codeplex.com/">BizTalk Deployment Framework</a> you can easily replicate your artefact's description on all you environments by exporting applications' bindings. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum2.png" alt="" />
	</p><p>In our projects, we wanted to fully use embedded documentation for the BizTalk Solutions, but the previous Documenter has some minor bugs and Receive Ports, Schemas and Pipelines did not include the description field as part of the generated documentation. I've fixed them by updating some ".xslt" files and a class of the BizTalkOM library; and now the output includes description for all different artefacts.
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum3.png" alt="" />
	</p><h1><span style="font-size:12pt;">3. Include your ESB Itineraries as part of your documentation. 
</span></h1><p>The BizTalk ESB Toolkit provides a lot of functionality which allows and simplifies the implementation of an Enterprise Service Bus; and ESB Itineraries are usually a key component of these solutions. That said, when they are part of a solution, itineraries should be within the documentation to fully understand the solution as a whole. 
</p><p>However, itineraries are not documented in the BizTalk Documenter out-of-the-box. One way to do it is to create a web page which briefly describes the itinerary and attach it to the documentation. There is a simple and easy way to do it. The first step is to create a Word document, including a picture of the itinerary designer, a description of its purpose and functionality, and the configuration of the resolvers. Then, after creating this document, save it as a Single File Web Page (.mht).
</p><p>
	</p><p>I've introduced a change to the BizTalk Documenter to accept not only ".htm" and ".html" files as additional resources, but ".mht" files also. The big advantage of this is that documentation which includes images can be created on Word, saved as a ".mht" file and easily added to the BizTalk documentation. 
</p><p>Once created the documentation for each itinerary, they should be saved in a subfolder which can be called "<strong>Itineraries</strong>". I suggest this folder name to have a clear structure in the generated documentation, but it can be set according the specific needs. This folder should be under a "<strong>Resources</strong>" folder which will be selected during the creation of the documentation. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum5.png" alt="" />
	</p><p>The last step is to be executed when generating the documentation. Under the "<strong>Output Options</strong>" page, in the "<strong>Advanced Documentation Options</strong>" section, the <strong>Resources</strong> folder which contains the <strong>Itineraries</strong> folder should be selected. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum6.png" alt="" />
	</p><p>Doing so, the generated documentation should have the "<strong>Itineraries</strong>" branch under "<strong>Additional Notes</strong>", and under this, the list of itineraries. This way, these important components of your BizTalk solutions are now part of your documentation. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum7.png" alt="" />
	</p><h1><span style="font-size:12pt;">4. Document your Maps 
</span></h1><p>We have incorporated the functionality of another Codeplex project, the <a href="https://biztalkmapdoc.codeplex.com/">BizTalk Map Documenter</a>, as part of the BizTalk Documenter. If you want to include documentation of your maps in more detail, the BizTalk mapper ".btm" source files must be available, and the following steps must be executed when generating the BizTalk documentation. 
</p><p>First, copy the BizTalk mapper files of the BizTalk Applications that are to be documented into a folder named "<strong>BtmSourceFiles</strong>". Then, rename the maps so that they have the full name as they appear in the BizTalk Admin Console, but here including the ".btm" extension. And finally copy the "BtmSourceFiles" folder under your <strong>Resources</strong> Folder to be selected in the Documenter <strong>Output Options</strong>. The "BtmSourceFiles" name of the folder and the full name of the maps <span style="text-decoration:underline;">are required</span> for the Documenter to be able to document in detail the maps. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum8.png" alt="" />
	</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum9.png" alt="" />
	</p><p>In the following screenshots it can be seen the detailed BizTalk map documentation which you can expect. It shows direct links between source and target nodes, functoids, and constant values utilised in the map.  
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum10.png" alt="" />
	</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum11.png" alt="" />
	</p><h1><span style="font-size:12pt;">5. Enrich your documentation with other relevant information  
</span></h1><p>In the tip #3, I mentioned how you can include your itineraries as part of your documentation. In addition to that, you can enrich your documentation with any Word or Excel document saved as ".mht" file or any other html file which is relevant to your solution. As an example, you could include the SettingsFileGenerator file of the BizTalk Deployment Framework. You just need to open it on Excel and save it as ".mht" file. This file must be saved in the corresponding folder under your Resources folder selected when you create the BizTalk Documentation. This way, your settings for Deployment can be included in your documentation. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum12.png" alt="" />
	</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum13.png" alt="" />
	</p><h1><span style="font-size:12pt;">6. Document only artefacts relevant to your solution.
</span></h1><p>Previous versions of the BizTalk Documenter allowed you to select those BizTalk applications to be included in the documentation. However, the Platform Settings and Business Rule Engine sections of the generated documentation always included all hosts, adapters, policies and vocabularies. In some projects, we had the need of documenting only those hosts, adapters, and BRE artefacts relevant to the solutions in scope. To satisfy this need, I added the "<strong>Additional Filters</strong>" page on the Documenter. On this page, you can filter hosts, adapters and BRE artefacts. Filters are applied using a "<strong>StartWith</strong>" function, which means that all artefacts starting with the filter will be included. Multiple filters can defined using a "|" (pipe) delimiter. The following screenshots show the configuration and the output of this new functionality. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum14.png" alt="" />
	</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum15.png" alt="" />
	</p><h1><span style="font-size:12pt;">7. Put a nice cover to your documentation. 
</span></h1><p>The icing on the cake of a good documentation would be to put a nice cover which is aligned to your needs. To do this, you need to add a custom "<strong>titlePage.htm</strong>" file on the root of your <strong>Resources </strong>folder selected in the <strong>Output Options</strong> tabs. If you are using your own custom images, you need to add them to the same root folder. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum16.png" alt="" />
	</p><p>The default cover page and a customised one can be seen in the following two images. 
</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum17.png" alt="" />
	</p><p><img src="/assets/img/2015/03/031815_1102_betterdocum18.png" alt="" />
	</p><p>The option of customising the cover page has been available since past versions of the Documenter, but in order to get the template of it, the source code has to be downloaded. Here I am providing the template which you can customise according to your needs. 
</p><p>&lt;GIT HUB CODE HERE&gt; 
</p><p>Note that the template makes use of a stylesheet and images which are part of the documenter. You can use yours by adding them in the same <strong>Resources</strong> root folder. You can freely customise this html according to your preferences and needs. 
</p><p>
 </p><p>I hope you find these tips useful and the BizTalk Documenter can help you to provide a comprehensive and quality documentation to your implemented BizTalk solutions. Please feel free to suggest to the team your ideas or improvements for the BizTalk Documenter on the Codeplex page. </p>
